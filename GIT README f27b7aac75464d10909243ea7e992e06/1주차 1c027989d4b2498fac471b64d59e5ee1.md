# 1ì£¼ì°¨

## 1. ê°•ì˜ ë‚´ìš©

[ì—°í•©í•™ìŠµ Week-1 ê°•ì˜ (9/2, ê¸ˆ)](https://github.com/Kwangkee/Gachon/blob/main/lecture_2022_fall.md#week-1)Â ì–´ë– ì…¨ìŠµë‹ˆê¹Œ?
ì˜ˆìƒ/ê¸°ëŒ€í•œ ë‚´ìš©ì´ì—ˆëŠ”ì§€? ë„ˆë¬´ ì–´ë µê±°ë‚˜ í‰ì´í•œ ë‚´ìš©ì€ ì•„ë‹ˆì—ˆëŠ”ì§€?
ê°•ì˜ ë‚´ìš©/ë°©ë²•ì— ê°œì„ í•  ì‚¬í•­ì€ ì—†ì„ì§€?
ë“±ë“±Â í¬í•¨í•´ì„œ,Â ë³¸ class ì— ê¸°ëŒ€í•˜ëŠ” ë°”, ì œì•ˆ ì‚¬í•­ ì•Œë ¤ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.

<aside>
ğŸ’¬ ì—°í•©í•™ìŠµì— ëŒ€í•´ ì‰½ê²Œ ì„¤ëª…í•´ì£¼ì…”ì„œ ê°œë…ì„ ì´í•´í•˜ì˜€ìŠµë‹ˆë‹¤. ì¶”ê°€ì ìœ¼ë¡œ, ê°„ë‹¨í•œ ì‹¤ìŠµ ì˜ˆì œì—ì„œì˜ ê³¼ì •ì„ ì‹œê°í™”í•˜ì—¬, ì—°í•©í•™ìŠµì„ ì‹¤ì œì ìœ¼ë¡œ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ Flowchart ì²˜ëŸ¼ ë³´ì´ë©´ ì´ë¡ ê³¼ ì‹¤ë¬´ ì‚¬ì´ì˜ ì°¨ì´ê°€ ì¤„ì–´ë“¤ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

</aside>

## 2. Week-2 Open Platform ì‚¬ìš©

ì‚¬ëŒë“¤ì´ ì‹¤ìŠµí•´ë³¸ ê²ƒì„ í™•ì¸í•´ë³´ê³ , ê°œì¸ì ìœ¼ë¡œ ë” ì‹¤ìŠµí•´ë³´ê³ , **ë‚˜ì¤‘ì— ë°œí‘œ**í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

## 3. ê¹€ëŒ€ì—´ ë°•ì‚¬ë‹˜ Homework

1. **Custom Data ìƒì„±**
    
    ```python
    class Dataset(Dataset):
        def __init__(self, task='train'):
            super().__init__()
            self.transforms = transforms.Compose([
                transforms.RandomRotation(degrees=30),
                transforms.RandomResizedCrop(size=(28, 28), scale=(0.8, 1.2), ratio=(1, 1))
            ])
    
            train_dataframe = pd.read_csv('dataset/train.csv') / 255
            test_dataframe = pd.read_csv('dataset/test.csv') / 255
            test_label_dataframe = pd.read_csv('dataset/sample_submission.csv')
    
            train_label = train_dataframe.label
            train_input = train_dataframe.drop('label', axis=1)
            train_input = train_input.values.reshape(-1, 1, 28, 28)
    
            test_dataset = test_dataframe.values.reshape(-1, 1, 28, 28)
            test_label = test_label_dataframe.Label
    
            self.task = task
    
            if self.task == 'train':
                self.input = torch.from_numpy(train_input.astype(np.float32))
                self.label = torch.from_numpy(train_label.values)
    
            elif self.task == 'test':
                self.input = torch.from_numpy(test_dataset.astype(np.float32))
                self.label = torch.from_numpy(test_label.values)
    
        def __len__(self):
            return self.input.shape[0]
    
        def __getitem__(self, idx):
            if self.task == 'train':
                input_data = self.input[idx]
                input_data = self.transform(input_data)
    
            elif self.task == 'test':
                input_data = self.input[idx]
            return input_data, self.label[idx]
    ```
    
2. **CNNëª¨ë¸ ìƒì„±**
    
    ```python
    class SimpleCNN(nn.Module):
        def __init__(self, conv1_channels=64, conv2_channels=128, linear1_size=256, linear2_size=128, dropout=0.1):
            super().__init__()
            self.conv1 = nn.Conv2d(in_channels=1, out_channels=conv1_channels, kernel_size=5, stride=1, padding=2)
            self.pool = nn.MaxPool2d(kernel_size=2, stride=2, padding=0)
            self.conv2 = nn.Conv2d(in_channels=conv1_channels, out_channels=conv2_channels, kernel_size=3, stride=1, padding=1)
    
            self.flat = nn.Flatten()
            self.fc1 = nn.Linear(in_features=conv2_channels*7*7, out_features=linear1_size)
            self.fc2 = nn.Linear(in_features=linear2_size, out_features=10)
            self.relu = nn.ReLU()
            self.drop = nn.Dropout(p=dropout)
    
        def forward(self, x):
            out = self.conv1(x)
            out = self.relu(out)
            out = self.pool(out)
    
            out = self.conv2(out)
            out = self.relu(out)
            out = self.pool(out)
    
            out = self.flat(out)
            out = self.fc1(out)
            out = self.relu(out)
            out = self.drop(out)
    
            out = self.fc2(out)
            return out
    ```
    
3. **Optimizer, loss ì„¤ì •**
    
    ```python
    criterion = nn.CrossEntropyLoss()
    optimizer = optim.Adam(model.parameters(), lr=lr)
    scheduler = StepLR(optimizer, step_size=1, gamma=gamma)
    ```
    
4. **Torch.save ëª¨ë¸ ì €ì¥**
    
    Epochë§ˆë‹¤ ì •í™•ë„ ì²´í¬ í›„ ê°€ì¥ ë†’ì€ ì •í™•ë„ë¥¼ ê°€ì§„ ëª¨ë¸ ì €ì¥
    
    ```python
    filename = f'best_model/[ep{best_epoch}_{best_accuracy:0.3f}].pth'
    torch.save(model, filename)
    ```
    
    ![Untitled](1%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%201c027989d4b2498fac471b64d59e5ee1/Untitled.png)
    

1. **wandb ëª¨ë‹ˆí„°ë§**
    
    wandb ì‚¬ìš©ì‹œ ë¸”ë£¨ìŠ¤í¬ë¦° ë¬¸ì œê°€ 5íšŒ ì´ìƒ ë°œìƒí•˜ì—¬ ë¬¸ì œí•´ê²°ì„ ìœ„í•´ ê²€ìƒ‰í•´ë³´ë‹ˆ,
    
    NVIDIA ê·¸ë˜í”½ ë“œë¼ì´ë²„ì™€ wandbê°€ ì¶©ëŒí•˜ì—¬ ë¬¸ì œê°€ ë°œìƒí•œë‹¤ í•˜ì˜€ìŠµë‹ˆë‹¤.
    
    ì´ë¥¼ ìœ„í•´ ì˜¤ë¥˜ ìˆ˜ì •ì„ ê³„ì† ì§„í–‰í•˜ì˜€ìœ¼ë‚˜, ê²°ë¡ ì ìœ¼ë¡œ ê³„ì† ì‹œìŠ¤í…œì´ ë‹¤ìš´ë˜ì–´ wandbì‚¬ìš©ì„ í•˜ì§€ ì•Šê³  ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.
    

![Untitled](1%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%201c027989d4b2498fac471b64d59e5ee1/Untitled%201.png)

![Untitled](1%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%201c027989d4b2498fac471b64d59e5ee1/Untitled%202.png)